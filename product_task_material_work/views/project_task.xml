<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<record model="ir.ui.view" id="view_project_task_by_administration_form">
        <field name="name">project.task.by.administration.form.inherit</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
        	<div name="button_box" position="inside">
                <field name="task_to_invoice" invisible="1"/>
        		<button name="sale_order_action_recalculate" type="object" class="oe_stat_button"
                    icon="fa-file-text-o" attrs="{'invisible': [('task_to_invoice', '=', False)]}"  
                    string="Por Admon." confirm="¿Estas seguro que quiere pasarlo a 'Por Administración'?">
        			<field name="by_administration" widget="toggle_button"/>
        		</button>
        	</div>
            <field name="stage_id" position="before">
                <button
                    class="oe_stat_button"
                    type="action"
                    name="%(project_task_convert2order_action)d"
                    attrs="{'invisible': ['|',('allow_billable', '=', False),('sale_line_id', '!=', False)]}" 
                    string="Crear presupuesto"
                    groups="project.group_project_manager"
                />
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="project_task_oppor_form_view">
        <field name="name">project.task.oppor.form</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='description_page']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
            
            <xpath expr="//field[@name='date_deadline']" position='before'>
                <field name="oppor_id" class="oe_inline"/>
                <field name="date_task"/>
            </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="view_project_task_work_form">
        <field name="name">project.task.work.form.inherit</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="hr_timesheet.view_task_form2_inherited"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='timesheet_ids']" position='before'>
                <separator string="Trabajo realizado"/>
            </xpath>
            <xpath expr="//field[@name='timesheet_ids']" position='after'>
                <separator string="Tareas a realizar"/>
                <field name="task_works_ids" nolabel="1" context="{'default_product_id': active_id}">
                    <tree string="Trabajos" editable="bottom">
                        <field name="sequence" widget="handle"/>
                        <!-- Solo los productos de tipo servicio -->
                        <field name="work_id" domain="[('type', '=', 'service')]"/>
                        <field name="name"/>
                        <field name="hours" sum="Horas totales" widget="float_time"/>
                        <field name="to_done"/>
                        <field name="validated"/>
                    </tree>
                </field>
                <separator string="Trabajo a realizar"/>
                <field name="work_to_do" class="oe_clear"/>
            </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="project_task_digitized_signature_material_inherited_form_view">
        <field name="name">project.task.digitized.signature.material.inherited.form</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='extra_info']" position="before">
                <page name="material_used" string="Material" groups="project.group_project_user">
                    <field name="material_ids">
                        <tree string="Material Used" editable="top">
                            <field name="product_id"/>
                            <field name="quantity"/>
                        </tree>
                    </field>
                </page>
                <page string="Firma">
                    <group>
                        <field name="signature" widget="signature" />
                        <field name="sign_by" />
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record model="ir.ui.view" id="view_project_task_form_material_inherited">
        <field name="name">project.task.form.material.inherited</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project_task_material.view_project_task_form_material"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='material_used']" position="replace">
                
            </xpath>
        </field>
    </record>

    <!--<record model="ir.ui.view" id="edit_project_task_track_translation">
        <field name="name">edit.project.task.track.translation</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="sale_order_invoicing_finished_task.edit_project_task_track"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[@name='toggle_invoiceable']" position="replace">
                <button name="toggle_invoiceable" type="object"
                    attrs="{'invisible': [('invoicing_finished_task','=', False)]}"
                    class="oe_stat_button" icon="fa-file">
                        <field name="invoiceable" widget="boolean_button"
                             options='{"terminology": {
                                    "string_true": "Facturable",
                                    "hover_true": "No Facturable",
                                    "string_false": "No Facturable",
                                    "hover_false": "Facturable"
                                }}'/>
                </button>
            </xpath>
        </field>
    </record>-->

</odoo>